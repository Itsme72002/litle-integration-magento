<?php
/**
 * Magento
 *
 * NOTICE OF LICENSE
 *
 * This source file is subject to the Academic Free License (AFL 3.0)
 * that is bundled with this package in the file LICENSE_AFL.txt.
 * It is also available through the world-wide-web at this URL:
 * http://opensource.org/licenses/afl-3.0.php
 * If you did not receive a copy of the license and are unable to
 * obtain it through the world-wide-web, please send an email
 * to license@magentocommerce.com so we can send you a copy immediately.
 *
 * DISCLAIMER
 *
 * Do not edit or add to this file if you wish to upgrade Magento to newer
 * versions in the future. If you wish to customize Magento for your
 * needs please refer to http://www.magentocommerce.com for more information.
 *
 * @category    design
 * @package     default_default
 * @copyright   Copyright (c) 2011 Magento Inc. (http://www.magentocommerce.com)
 * @license     http://opensource.org/licenses/afl-3.0.php  Academic Free License (AFL 3.0)
 */
?>
<!-- Addresses list -->

<?php $active = $this->getActive();?>
<table cellspacing="0" class="form-edit">
	<tr>
		<td class="address-list">
			<div class="content-header">
				<h3 class="icon-head head-sales-order">
					
				<?php echo Mage::helper('customer')->__('Subscription Details') ?>
				</h3>
			</div>
			<ul class="messages">

			<?php if ($active == 0):?>
				<ul>
					<li><span>Subscription is not active.</span></li>
				</ul>
				
				
				<?php else: $messageInfo = $this->getSubscriptionStatusMessage();?>
				<li class=<?php echo $messageInfo[0]?>>
					<ul>
						<li><span><?php echo $messageInfo[1];?></span>
						</li>
					</ul>
				</li>
				<?php endif;?>
			</ul>

			<div class="hor-scroll">
				<table class="form-list" cellspacing="0">
					<tbody>
						<tr>
							<td class="label"><label>Subscription ID:</label></td>
							<td class="value"><?php echo $this->getSubscriptionId()?></td>
						</tr>
						<tr>
							<td class="label"><label>Product Name:</label></td>
							<td class="value"><?php echo $this->getSubscriptionName()?></td>
						</tr>
						<tr>
							<td class="label"><label>Date Started:</label></td>
							<td class="value"><?php echo $this->getStartDate()?></td>
						</tr>
						<tr>
							<td class="label"><label>Initial Fees:</label></td>
							<td class="value"><?php echo $this->getInitialFees()?></td>
						</tr>
						<tr>
							<td class="label"><label for="recurring_fees">Recurring Fees:</label>
							</td>
							<td class="value">
							<?php if ($active == 1):?> <input id="recurring_fees"
								class="input-type required-entry" type="text"
								value=<?php echo $this->getSubscriptionAmount()?>></input>
							
							
								<?php else:?>
								<?php echo $this->getSubscriptionAmount()?>
								<?php endif;?>
							</td>
						</tr>
						<tr>
							<td class="label"><label for="billing_cycle_period">Billing Cycle
									Period:</label></td>
							<td class="value">
							<?php if ($active == 1):?> <select id="billing_period"

							<?php $cycleArray = array('Daily','Weekly','Bi-Weekly','Semi-Monthly','Monthly','Semi-Annually','Annually');?>

							<?php foreach ($cycleArray as $key => $value): ?>

							<?php if($this->getIterationLength() !== $value): ?>
								<option>
										<?php echo $value; ?>
									</option>
									<?php endif; ?>
									<?php if($this->getIterationLength() === $value): ?>
								<option selected>
										<?php echo $value; ?>
									</option>
									<?php endif; ?>
									<?php endforeach ?></select>
							<?php else:?>
								<?php echo $this->getIterationLength()?>
								<?php endif;?>
							</td>
						</tr>
						<tr>
							<td class="label"><label for="total_number_of_billing_cycles">Total
									Number of Billing Cycles:</label>
							</td>
							<td class="value">
							<?php if ($active == 1):?>
							<input id="total_number_of_billing_cycles"
								class="input-type required-entry" type="text"
								value=<?php echo $this->getNumOfIterations()?>></input>
								<?php else:?>
								<?php echo $this->getNumOfIterations()?>
								<?php endif;?>
							</td>
						</tr>
						<tr>
							<td class="label"><label>Number of Billing Cycles Over:</label>
							</td>
							<td class="value"><?php echo $this->getNumOfIterationsRan()?>
							</td>
						</tr>
						<tr>
							<td class="label"><label>Next Bill Date:</label>
							</td>
							<td class="value"><?php echo $this->getNextBillDate()?>
							</td>
						</tr>
						<tr>
							<td class="label"><label>Is Recycling?:</label>
							</td>
							<td class="value"><?php echo $this->getIsRecycling()?>
							</td>
						</tr>
						<tr>
							<td class="label"><label>Next Recycling Attempt:</label>
							</td>
							<td class="value"><?php echo $this->getNextRecycleAttempt()?>
							</td>
						</tr>
					</tbody>
				</table>
			</div>
		</td>
	</tr>
	<div align="right">
<?php if ($active === '1'):?>
	<?php echo $this->getChildHtml('cancel_button') ?> &nbsp
	<?php echo $this->getChildHtml('suspend_button') ?> &nbsp
	<?php echo $this->getChildHtml('save_button') ?> &nbsp
	<?php if ($this->showResumeButton()): ?>
		<?php echo $this->getChildHtml('resume_button') ?>
	<?php endif?>
<?php endif?>
	</div>
	
</table>
<br>
<div>
	<div class="content-header">
		<h3 class="icon-head head-sales-order">
			<?php echo Mage::helper('customer')->__('Subscription History:') ?>
		</h3>
	</div>
	<?php $historyRow = $this->getSubscriptionHistoryTable();?>
	<div style="position:relative; height:200px; overflow:auto;">
		<?php if($historyRow!==NULL):?>
		<table cellspacing="0" border="1" width=50%>
			<thead>
			<tr>
				<th>&nbsp Cron ID</th>
				<th>&nbsp Order ID</th>
				<th>&nbsp Sucessful</th>
				<th>&nbsp Run Date</th>
			</tr>
			</thead>
			<?php foreach ($historyRow as $key => $value): ?>
			<tr>
				<td align=center><?php echo $historyRow[$key]["cron_id"];?></td>
				<td align=center><?php echo $historyRow[$key]["order_id"];?></td>
				<td align=center><?php echo $historyRow[$key]["success"];?></td>
				<td align=center><?php echo $historyRow[$key]["run_date"];?></td>
			</tr>
			<?php endforeach ?>
		</table>
		<?php else: ?>
		<td class="label"><label>This Subscription has no history.</label>
		</td>
		<?php endif ?>
</div>
